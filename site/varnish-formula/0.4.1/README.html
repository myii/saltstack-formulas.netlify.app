<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>varnish-formula :: SaltStack Formulas</title>
    <link rel="canonical" href="https://saltstack-formulas.netlify.app/varnish-formula/0.4.1/README.html">
    <link rel="next" href="CHANGELOG.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/site-extra.css">
    <script>var uiRootPath = '../../_'</script>
    <link rel="icon" href="../../_/img/ssf/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://saltstack-formulas.netlify.app">
        <!-- <img src="../../_/img/ssf/SaltStack.png" alt="SaltStack" style="width:30px;height:30px;" />&#38;nbsp;SaltStack Formulas -->
        <img src="../../_/img/ssf/SaltStack.png" alt="SaltStack" style="width:25px;height:25px;" />&nbsp;SaltStack Formulas
      </a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- <div class="navbar&#45;item&#45;divider"></div>  -->
        <!-- <a class="navbar&#45;item" href="#">Home</a> -->
        <!-- <div class="navbar&#45;item has&#45;dropdown is&#45;hoverable"> -->
        <!--   <a class="navbar&#45;link" href="#">Products</a> -->
        <!--   <div class="navbar&#45;dropdown"> -->
        <!--     <a class="navbar&#45;item" href="#">Product A</a> -->
        <!--     <a class="navbar&#45;item" href="#">Product B</a> -->
        <!--     <a class="navbar&#45;item" href="#">Product C</a> -->
        <!--   </div> -->
        <!-- </div> -->
        <!-- <div class="navbar&#45;item has&#45;dropdown is&#45;hoverable"> -->
        <!--   <a class="navbar&#45;link" href="#">Services</a> -->
        <!--   <div class="navbar&#45;dropdown"> -->
        <!--     <a class="navbar&#45;item" href="#">Service A</a> -->
        <!--     <a class="navbar&#45;item" href="#">Service B</a> -->
        <!--     <a class="navbar&#45;item" href="#">Service C</a> -->
        <!--   </div> -->
        <!-- </div> -->
        <!-- <div class="navbar&#45;item has&#45;dropdown is&#45;hoverable"> -->
        <!--   <a class="navbar&#45;link" href="#">Resources</a> -->
        <!--   <div class="navbar&#45;dropdown"> -->
        <!--     <a class="navbar&#45;item" href="#">Resource A</a> -->
        <!--     <a class="navbar&#45;item" href="#">Resource B</a> -->
        <!--     <a class="navbar&#45;item" href="#">Resource C</a> -->
        <!--   </div> -->
        <!-- </div> -->

        <!-- Have these in a separate `div`? -->

        <!-- Repos -->
        <div class="navbar-item-divider"></div> 
        <a class="navbar-item" href="https://github.com/saltstack-formulas" target="_blank">
          <!-- <img src="../../_/img/ssf/GitHub.png" alt="GitHub" style="width:30px;height:30px;" /> -->
          <img src="../../_/img/ssf/GitHub.png" alt="GitHub" style="width:25px;height:25px;" />
        </a>
        <a class="navbar-item" href="https://gitlab.com/saltstack-formulas" target="_blank">
          <!-- 714 x 660 -->
          <!-- <img src="../../_/img/ssf/GitLab.png" alt="GitLab" style="width:32.5px;height:30px;" /> -->
          <img src="../../_/img/ssf/GitLab.png" alt="GitLab" style="width:27px;height:25px;" />
        </a>

        <!-- Pre-salted images and boxes -->
        <div class="navbar-item-divider"></div> 
        <a class="navbar-item" href="https://hub.docker.com/u/saltimages" target="_blank">
          <!-- 1008 x 722 -->
          <!-- <img src="../../_/img/ssf/Docker_Hub.png" alt="Docker Hub" style="width:33.5px;height:24px;" /> -->
          <img src="../../_/img/ssf/Docker_Hub.png" alt="Docker Hub" style="width:27.9px;height:20px;" />
        </a>
        <a class="navbar-item" href="https://app.vagrantup.com/boxes/search?provider=virtualbox&q=%22Pre-salted+minion%22" target="_blank">
          <!-- 1182 x 1220 -->
          <!-- <img src="../../_/img/ssf/Vagrant_Cloud.png" alt="Vagrant Cloud" style="width:23.3px;height:24px;" /> -->
          <img src="../../_/img/ssf/Vagrant_Cloud.png" alt="Vagrant Cloud" style="width:19.4px;height:20px;" />
        </a>

        <!-- Chat -->
        <div class="navbar-item-divider"></div> 
        <a class="navbar-item" href="https://saltstackcommunity.slack.com/messages/C7LG8SV54/" target="_blank">
          <!-- <img src="../../_/img/ssf/Slack.png" alt="Slack" style="width:30px;height:30px;" /> -->
          <img src="../../_/img/ssf/Slack.png" alt="Slack" style="width:20px;height:20px;" />
        </a>
        <a class="navbar-item" href="https://matrix.to/#/#saltstack-formulas:matrix.org" target="_blank">
          <!-- 499 x 520 -->
          <img src="../../_/img/ssf/Matrix.png" alt="Matrix" style="width:22.1px;height:23px;" />
        </a>
        <a class="navbar-item" href="https://t.me/saltstack_formulas" target="_blank">
          <img src="../../_/img/ssf/Telegram.svg" alt="Telegram" style="width:22px;height:22px;" />
        </a>
        <!-- ircs://chat.freenode.net/saltstack-formulas -->
        <a class="navbar-item" href="https://webchat.freenode.net/?channels=saltstack-formulas" target="_blank">
          <!-- 271 x 55 -->
          <!-- <img src="../../_/img/ssf/Freenode.png" alt="Freenode" style="width:73.9px;height:15px;" /> -->
          <!-- <img src="../../_/img/ssf/Freenode.png" alt="Freenode" style="width:59.1px;height:12px;" /> -->
          <!-- 64 x 55 -->
          <img src="../../_/img/ssf/Freenode.png" alt="Freenode" style="width:23.3px;height:20px;" />
        </a>
        <a class="navbar-item" href="https://freenode.logbot.info/saltstack-formulas" target="_blank">
          <!-- 83 x 62 -->
          <img src="../../_/img/ssf/LogBot.svg" alt="LogBot" style="width:26.8px;height:20px;" />
        </a>
        <a class="navbar-item" href="https://saltstack-formulas.zulipchat.com" target="_blank">
          <!-- 360 x 401 -->
          <!-- <img src="../../_/img/ssf/Zulip.svg" alt="Zulip" style="width:21.5px;height:24px;" /> -->
          <img src="../../_/img/ssf/Zulip.svg" alt="Zulip" style="width:18px;height:20px;" />
        </a>

        <!-- Working group: project management -->
        <div class="navbar-item-divider"></div> 
        <a class="navbar-item" href="https://tree.taiga.io/project/myii-saltstack-formulas" target="_blank">
          <!-- <img src="../../_/img/ssf/Taiga.png" alt="Taiga" style="width:30px;height:30px;" /> -->
          <img src="../../_/img/ssf/Taiga.png" alt="Taiga" style="width:25px;height:25px;" />
        </a>
        <a class="navbar-item" href="https://meet.jit.si/myiisaltstackformulas" target="_blank">
          <!-- 712 x 1056 -->
          <!-- <img src="../../_/img/ssf/Jitsi.png" alt="Jitsi" style="width:24.2px;height:36px;" /> -->
          <img src="../../_/img/ssf/Jitsi.png" alt="Jitsi" style="width:20.2px;height:30px;" />
        </a>

        <!-- Working group: meetings & recordings -->
        <div class="navbar-item-divider"></div> 
        <a class="navbar-item" href="https://VMware.zoom.us/j/98009043675?pwd=cm0rOXNZL0lrVFlzZHZkSUprVnZ6dz09" target="_blank">
          <!-- 4094 x 920 -->
          <!-- <img src="../../_/img/ssf/Zoom.png" alt="Zoom" style="width:53.4px;height:12px;" /> -->
          <!-- <img src="../../_/img/ssf/Zoom.png" alt="Zoom" style="width:44.5px;height:10px;" /> -->
          <!-- 625 x 625 -->
          <img src="../../_/img/ssf/Zoom.png" alt="Zoom" style="width:23px;height:23px;" />
        </a>
        <a class="navbar-item" href="https://www.youtube.com/watch?v=P5k5W6iEl_c&list=PL9svBjLDUl_8QNmemBGKnEyRTcLl4or6f" target="_blank">
          <!-- 611 x 429 -->
          <!-- <img src="../../_/img/ssf/YouTube.png" alt="YouTube" style="width:34.2px;height:24px;" /> -->
          <img src="../../_/img/ssf/YouTube.png" alt="YouTube" style="width:28.5px;height:20px;" />
        </a>

        <!-- Other -->
        <div class="navbar-item-divider"></div> 
        <a class="navbar-item" href="https://cauldron.io/project/314" target="_blank">
          <!-- <img src="../../_/img/ssf/Kibana.png" alt="Kibana" style="width:30px;height:30px;" /> -->
          <img src="../../_/img/ssf/Kibana.png" alt="Kibana" style="width:24px;height:24px;" />
        </a>

        <!-- Search -->
        <div class="navbar-item-divider"></div> 
        <div class="navbar-item">
          <input id="search-input" type="text" placeholder="Search docs">
        </div>
        
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="varnish-formula" data-version="0.4.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="README.html">varnish-formula</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Repo documentation</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="README.html">README</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="#_available_states">Available states</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="CHANGELOG.html">Changelog</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="AUTHORS.html">Contributors</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Explanations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#explanation-.adoc">&#8230;&#8203;</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Guides</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#guide-.adoc">&#8230;&#8203;</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">References</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#reference-.adoc">&#8230;&#8203;</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#tutorial-.adoc">&#8230;&#8203;</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">varnish-formula</span>
    <span class="version">0.4.1</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../apache-formula/1.1.3/README.html">apache-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../apache-formula/1.1.3/README.html">1.1.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../apt-cacher-formula/0.7.3/README.html">apt-cacher-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../apt-cacher-formula/0.7.3/README.html">0.7.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../apt-formula/0.9.1/README.html">apt-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../apt-formula/0.9.1/README.html">0.9.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../arvados-formula/1.1.4/README.html">arvados-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../arvados-formula/1.1.4/README.html">1.1.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../bind-formula/0.19.2/README.html">bind-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../bind-formula/0.19.2/README.html">0.19.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../cert-formula/1.2.0/README.html">cert-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../cert-formula/1.2.0/README.html">1.2.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../chrony-formula/1.2.5/README.html">chrony-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../chrony-formula/1.2.5/README.html">1.2.5</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../collectd-formula/1.1.4/README.html">collectd-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../collectd-formula/1.1.4/README.html">1.1.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../consul-formula/1.0.0/README.html">consul-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../consul-formula/1.0.0/README.html">1.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../cron-formula/0.3.2/README.html">cron-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../cron-formula/0.3.2/README.html">0.3.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../deepsea-formula/1.1.0/README.html">deepsea-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../deepsea-formula/1.1.0/README.html">1.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devstack-formula/1.0.2/README.html">devstack-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../devstack-formula/1.0.2/README.html">1.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../dhcpd-formula/0.9.0/README.html">dhcpd-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../dhcpd-formula/0.9.0/README.html">0.9.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../django-formula/0.5.0/README.html">django-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../django-formula/0.5.0/README.html">0.5.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../docker-formula/2.0.3/README.html">docker-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../docker-formula/2.0.3/README.html">2.0.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../eclipse-formula/1.1.1/README.html">eclipse-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../eclipse-formula/1.1.1/README.html">1.1.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../epel-formula/1.15.5/README.html">epel-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../epel-formula/1.15.5/README.html">1.15.5</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../exim-formula/0.7.1/README.html">exim-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../exim-formula/0.7.1/README.html">0.7.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../fail2ban-formula/1.1.2/README.html">fail2ban-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../fail2ban-formula/1.1.2/README.html">1.1.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../firewalld-formula/1.2.1/README.html">firewalld-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../firewalld-formula/1.2.1/README.html">1.2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../golang-formula/0.7.5/README.html">golang-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../golang-formula/0.7.5/README.html">0.7.5</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../grafana-formula/3.1.2/README.html">grafana-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../grafana-formula/3.1.2/README.html">3.1.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../haproxy-formula/0.17.1/README.html">haproxy-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../haproxy-formula/0.17.1/README.html">0.17.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hostsfile-formula/0.8.1/README.html">hostsfile-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../hostsfile-formula/0.8.1/README.html">0.8.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../icinga2-formula/0.9.0/README.html">icinga2-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../icinga2-formula/0.9.0/README.html">0.9.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../influxdb-formula/0.3.3/README.html">influxdb-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../influxdb-formula/0.3.3/README.html">0.3.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../iptables-formula/0.17.4/README.html">iptables-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../iptables-formula/0.17.4/README.html">0.17.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../iscsi-formula/1.2.0/README.html">iscsi-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../iscsi-formula/1.2.0/README.html">1.2.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../java-formula/2.0.0/README.html">java-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../java-formula/2.0.0/README.html">2.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jetbrains-appcode-formula/1.0.3/README.html">jetbrains-appcode-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../jetbrains-appcode-formula/1.0.3/README.html">1.0.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jetbrains-clion-formula/1.2.1/README.html">jetbrains-clion-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../jetbrains-clion-formula/1.2.1/README.html">1.2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jetbrains-datagrip-formula/1.2.1/README.html">jetbrains-datagrip-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../jetbrains-datagrip-formula/1.2.1/README.html">1.2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jetbrains-goland-formula/1.2.1/README.html">jetbrains-goland-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../jetbrains-goland-formula/1.2.1/README.html">1.2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jetbrains-intellij-formula/1.2.1/README.html">jetbrains-intellij-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../jetbrains-intellij-formula/1.2.1/README.html">1.2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jetbrains-phpstorm-formula/1.2.1/README.html">jetbrains-phpstorm-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../jetbrains-phpstorm-formula/1.2.1/README.html">1.2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jetbrains-pycharm-formula/1.2.1/README.html">jetbrains-pycharm-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../jetbrains-pycharm-formula/1.2.1/README.html">1.2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jetbrains-resharper-formula/1.2.2/README.html">jetbrains-resharper-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../jetbrains-resharper-formula/1.2.2/README.html">1.2.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jetbrains-rider-formula/1.2.1/README.html">jetbrains-rider-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../jetbrains-rider-formula/1.2.1/README.html">1.2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jetbrains-rubymine-formula/1.1.1/README.html">jetbrains-rubymine-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../jetbrains-rubymine-formula/1.1.1/README.html">1.1.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jetbrains-webstorm-formula/1.2.1/README.html">jetbrains-webstorm-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../jetbrains-webstorm-formula/1.2.1/README.html">1.2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../keepalived-formula/0.6.0/README.html">keepalived-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../keepalived-formula/0.6.0/README.html">0.6.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../letsencrypt-formula/2.1.0/README.html">letsencrypt-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../letsencrypt-formula/2.1.0/README.html">2.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../libvirt-formula/3.9.0/README.html">libvirt-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../libvirt-formula/3.9.0/README.html">3.9.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../locale-formula/0.3.5/README.html">locale-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../locale-formula/0.3.5/README.html">0.3.5</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../logrotate-formula/0.9.0/README.html">logrotate-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../logrotate-formula/0.9.0/README.html">0.9.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../lvm-formula/0.3.3/README.html">lvm-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../lvm-formula/0.3.3/README.html">0.3.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../lynis-formula/0.4.2/README.html">lynis-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../lynis-formula/0.4.2/README.html">0.4.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../maven-formula/1.0.2/README.html">maven-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../maven-formula/1.0.2/README.html">1.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../mongodb-formula/1.0.2/README.html">mongodb-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../mongodb-formula/1.0.2/README.html">1.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../mysql-formula/0.55.1/README.html">mysql-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../mysql-formula/0.55.1/README.html">0.55.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../nfs-formula/0.12.0/README.html">nfs-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../nfs-formula/0.12.0/README.html">0.12.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../nginx-formula/2.7.0/README.html">nginx-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../nginx-formula/2.7.0/README.html">2.7.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../nifi-formula/0.8.0/README.html">nifi-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../nifi-formula/0.8.0/README.html">0.8.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../node-formula/1.0.1/README.html">node-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../node-formula/1.0.1/README.html">1.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../ntp-formula/0.19.2/README.html">ntp-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../ntp-formula/0.19.2/README.html">0.19.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../nut-formula/1.1.0/README.html">nut-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../nut-formula/1.1.0/README.html">1.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../openldap-formula/0.8.0/README.html">openldap-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../openldap-formula/0.8.0/README.html">0.8.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../openntpd-formula/0.2.4/README.html">openntpd-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../openntpd-formula/0.2.4/README.html">0.2.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../openssh-formula/3.0.1/README.html">openssh-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../openssh-formula/3.0.1/README.html">3.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../openvpn-formula/1.15.1/README.html">openvpn-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../openvpn-formula/1.15.1/README.html">1.15.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../packages-formula/0.9.0/README.html">packages-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../packages-formula/0.9.0/README.html">0.9.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../php-formula/1.4.0/README.html">php-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../php-formula/1.4.0/README.html">1.4.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../postfix-formula/2.0.0/README.html">postfix-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../postfix-formula/2.0.0/README.html">2.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../postgres-formula/0.41.7/README.html">postgres-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../postgres-formula/0.41.7/README.html">0.41.7</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../powerdns-formula/0.3.4/README.html">powerdns-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../powerdns-formula/0.3.4/README.html">0.3.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../proftpd-formula/0.5.0/README.html">proftpd-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../proftpd-formula/0.5.0/README.html">0.5.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../prometheus-formula/5.4.0/README.html">prometheus-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../prometheus-formula/5.4.0/README.html">5.4.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../rabbitmq-formula/1.0.0/README.html">rabbitmq-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../rabbitmq-formula/1.0.0/README.html">1.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../redis-formula/0.27.2/README.html">redis-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../redis-formula/0.27.2/README.html">0.27.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../rkhunter-formula/0.4.3/README.html">rkhunter-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../rkhunter-formula/0.4.3/README.html">0.4.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../rng-tools-formula/0.2.0/README.html">rng-tools-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../rng-tools-formula/0.2.0/README.html">0.2.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../rspamd-formula/0.1.3/README.html">rspamd-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../rspamd-formula/0.1.3/README.html">0.1.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../salt-formula/1.8.4/README.html">salt-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../salt-formula/1.8.4/README.html">1.8.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../main/1.1.0/index.html">SaltStack Formulas</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../main/1.1.0/index.html">1.1.0</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../main/1.0.3/README.html">1.0.3</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../main/1.0.2/README.html">1.0.2</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../main/1.0.1/README.html">1.0.1</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../main/1.0.0/README.html">1.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../sqldeveloper-formula/1.0.1/README.html">sqldeveloper-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../sqldeveloper-formula/1.0.1/README.html">1.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../sqlplus-formula/1.0.1/README.html">sqlplus-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../sqlplus-formula/1.0.1/README.html">1.0.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../strongswan-formula/0.3.0/README.html">strongswan-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../strongswan-formula/0.3.0/README.html">0.3.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../stunnel-formula/0.2.3/README.html">stunnel-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../stunnel-formula/0.2.3/README.html">0.2.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../sudoers-formula/0.23.4/README.html">sudoers-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../sudoers-formula/0.23.4/README.html">0.23.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../suricata-formula/1.0.2/README.html">suricata-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../suricata-formula/1.0.2/README.html">1.0.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../sysctl-formula/0.6.3/README.html">sysctl-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../sysctl-formula/0.6.3/README.html">0.6.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../syslog-ng-formula/0.5.1/README.html">syslog-ng-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../syslog-ng-formula/0.5.1/README.html">0.5.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../sysstat-formula/0.4.1/README.html">sysstat-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../sysstat-formula/0.4.1/README.html">0.4.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../systemd-formula/0.19.0/README.html">systemd-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../systemd-formula/0.19.0/README.html">0.19.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../telegraf-formula/1.0.3/README.html">telegraf-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../telegraf-formula/1.0.3/README.html">1.0.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../template-formula/1.3.17/README.html">template-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../template-formula/1.3.17/README.html">1.3.17</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.16/README.html">1.3.16</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.15/README.html">1.3.15</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.14/README.html">1.3.14</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.13/README.html">1.3.13</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.12/README.html">1.3.12</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.11/README.html">1.3.11</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.10/README.html">1.3.10</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.9/README.html">1.3.9</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.8/README.html">1.3.8</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.7/README.html">1.3.7</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.6/README.html">1.3.6</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.5/README.html">1.3.5</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.4/README.html">1.3.4</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.3/README.html">1.3.3</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.2/README.html">1.3.2</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.1/README.html">1.3.1</a>
        </li>
      </ul>
      <ul class="versions">
        <li class="version">
          <a href="../../template-formula/1.3.0/README.html">1.3.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../timezone-formula/0.4.4/README.html">timezone-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../timezone-formula/0.4.4/README.html">0.4.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../tomcat-formula/0.19.5/README.html">tomcat-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../tomcat-formula/0.19.5/README.html">0.19.5</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../ufw-formula/0.5.7/README.html">ufw-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../ufw-formula/0.5.7/README.html">0.5.7</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../users-formula/1.46.0/README.html">users-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../users-formula/1.46.0/README.html">1.46.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="README.html">varnish-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest is-current">
          <a href="README.html">0.4.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../vault-formula/1.2.5/README.html">vault-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../vault-formula/1.2.5/README.html">1.2.5</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../vim-formula/0.15.4/README.html">vim-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../vim-formula/0.15.4/README.html">0.15.4</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../vsftpd-formula/0.3.2/README.html">vsftpd-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../vsftpd-formula/0.3.2/README.html">0.3.2</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../zabbix-formula/1.1.0/README.html">zabbix-formula</a>
      <ul class="versions is-latest">
        <li class="version is-latest">
          <a href="../../zabbix-formula/1.1.0/README.html">1.1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../main/1.1.0/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="README.html">varnish-formula</a></li>
    <li>Repo documentation</li>
    <li><a href="README.html">README</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/myii/varnish-formula/edit/antora/docs/modules/ROOT/pages/README.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">varnish-formula</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://travis-ci.com/saltstack-formulas/varnish-formula"><span class="image"><img src="https://travis-ci.com/saltstack-formulas/varnish-formula.svg?branch=master" alt="Travis CI Build Status"></span></a>
<a href="https://github.com/semantic-release/semantic-release"><span class="image"><img src="https://img.shields.io/badge/%20%20%F0%9F%93%A6%F0%9F%9A%80-semantic&#8212;&#8203;release-e10079.svg" alt="Semantic Release"></span></a></p>
</div>
<div class="paragraph">
<p>A simple SaltStack formula to install and configure Varnish.</p>
</div>
<div class="paragraph">
<p>This formula has been developed distributing id and state declarations
in different files to make it usable in most situations. It should be
useful in scenarios ranging from a simple install of the packages
(without any special configuration) to a more complex set-up.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_general_notes"><a class="anchor" href="#_general_notes"></a>1. General notes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>See the full
<a href="https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html">SaltStack
Formulas installation and usage instructions</a>.</p>
</div>
<div class="paragraph">
<p>If you are interested in writing or contributing to formulas, please pay
attention to the
<a href="https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html#writing-formulas">Writing
Formula Section</a>.</p>
</div>
<div class="paragraph">
<p>If you want to use this formula, please pay attention to the <code>FORMULA</code>
file and/or <code>git tag</code>, which contains the currently released version.
This formula is versioned according to <a href="http://semver.org/">Semantic
Versioning</a>.</p>
</div>
<div class="paragraph">
<p>See
<a href="https://docs.saltstack.com/en/latest/topics/development/conventions/formulas.html#versioning">Formula
Versioning Section</a> for more details.</p>
</div>
<div class="paragraph">
<p>If you need (non-default) configuration, please pay attention to the
<code>pillar.example</code> file and/or <a href="#_special_notes">Special notes</a> section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contributing_to_this_repo"><a class="anchor" href="#_contributing_to_this_repo"></a>2. Contributing to this repo</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Commit message formatting is significant!!</strong></p>
</div>
<div class="paragraph">
<p>Please see
<a href="../../main/1.1.0/CONTRIBUTING.html" class="page">How
to contribute</a> for more details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_special_notes"><a class="anchor" href="#_special_notes"></a>3. Special notes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>None</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_general_customization_strategies"><a class="anchor" href="#_general_customization_strategies"></a>4. General customization strategies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First, <strong>see if providing pillar data is enough for your customization
needs</strong> That&#8217;s the recommended way and should be enough for most cases.
See that sometimes there&#8217;s a key named <code>extra_conf</code> that&#8217;s used to add
arbitrary configuration lines in the templates provided.</p>
</div>
<div class="paragraph">
<p>When providing pillar data is not enough for your needs, you can apply
the <em>Template Override and Files Switch</em> (TOFS) pattern as described in
the documentation file <code>TOFS_pattern.md</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_available_states"><a class="anchor" href="#_available_states"></a>5. Available states</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_varnish"><a class="anchor" href="#_varnish"></a>5.1. <code>varnish</code></h3>
<div class="paragraph">
<p>Installs the varnish package, and starts the associated varnish service.</p>
</div>
</div>
<div class="sect2">
<h3 id="_varnish_conf"><a class="anchor" href="#_varnish_conf"></a>5.2. <code>varnish.conf</code></h3>
<div class="paragraph">
<p>Configures the varnish package.</p>
</div>
</div>
<div class="sect2">
<h3 id="_varnish_repo"><a class="anchor" href="#_varnish_repo"></a>5.3. <code>varnish.repo</code></h3>
<div class="paragraph">
<p>Adds the varnish official repositories.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_next_generation_alternate_approach"><a class="anchor" href="#_next_generation_alternate_approach"></a>6. Next-generation, alternate approach</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following states provide an alternate approach to managing Varnish.
Tested in Ubuntu 14/16 and CentOS 6/7.</p>
</div>
<div class="sect2">
<h3 id="_varnish_ng"><a class="anchor" href="#_varnish_ng"></a>6.1. <code>varnish.ng</code></h3>
<div class="paragraph">
<p>Meta-state for inclusion of all ng states.</p>
</div>
</div>
<div class="sect2">
<h3 id="_varnish_ng_install"><a class="anchor" href="#_varnish_ng_install"></a>6.2. <code>varnish.ng.install</code></h3>
<div class="paragraph">
<p>Install varnish itself from custom-repo or stock-repo.</p>
</div>
</div>
<div class="sect2">
<h3 id="_varnish_ng_repo"><a class="anchor" href="#_varnish_ng_repo"></a>6.3. <code>varnish.ng.repo</code></h3>
<div class="paragraph">
<p>Install the packagecloud.io varnish repo. Repos available can be found
in <a href="https://packagecloud.io/varnishcache">packagecloud.io</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_varnish_ng_config"><a class="anchor" href="#_varnish_ng_config"></a>6.4. <code>varnish.ng.config</code></h3>
<div class="paragraph">
<p>Configure varnish (vcls and init files).</p>
</div>
</div>
<div class="sect2">
<h3 id="_varnish_ng_service"><a class="anchor" href="#_varnish_ng_service"></a>6.5. <code>varnish.ng.service</code></h3>
<div class="paragraph">
<p>Manage varnish and varnishncsa service.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_varnish_ng_considerations"><a class="anchor" href="#_varnish_ng_considerations"></a>7. Varnish NG considerations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because of the different OSes with different init programs (ubuntu14 -
init, ubuntu 16 - systemd, centos 6 - init, centos 7 - systemd), the
following considerations must be taken into account:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>VCL files must be copied to minions using <code>salt://</code> (see
pillar.example vcl section):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">varnish:
  ng:
    vcl:
      files:
        default:
          path: /etc/varnish/default.vcl
          source_path: salt://hostname/default.vcl.jinja
        mobile_detect:
          enabled: False
          path: /etc/varnish/mobile_detect.vcl
          source_path: salt://hostname/mobile_detect.vcl</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Config files (<code>/etc/default/varnish</code>, <code>/etc/sysconfig/varnish</code> or
<code>/etc/varnish/varnish.params</code>) can be copied with <code>salt://</code> or just
creating the variables in the <code>config_file</code> option:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">varnish:
  ng:
    config_source_path: salt://hostname/varnish.jinja</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">varnish:
  ng:
    config_file:
      NFILES: "131072"
      MEMLOCK: "82000"
      NPROCS: "unlimited"
      RELOAD_VCL: "1"
      VARNISH_VCL_CONF: "/etc/varnish/default.vcl"
      VARNISH_LISTEN_PORT: "6081"
      VARNISH_ADMIN_LISTEN_ADDRESS: "127.0.0.1"
      VARNISH_ADMIN_LISTEN_PORT: "6082"
      VARNISH_SECRET_FILE: "/etc/varnish/secret"
      VARNISH_MIN_THREADS: "50"
      VARNISH_MAX_THREADS: "1000"
      VARNISH_STORAGE_SIZE: "100M"
      VARNISH_STORAGE: "malloc,${VARNISH_STORAGE_SIZE}"
      VARNISH_TTL: "120"
      DAEMON_OPTS: "-a ${VARNISH_LISTEN_ADDRESS}:${VARNISH_LISTEN_PORT} -f ${VARNISH_VCL_CONF} -T ${VARNISH_ADMIN_LISTEN_ADDRESS}:${VARNISH_ADMIN_LISTEN_PORT} -p thread_pool_min=${VARNISH_MIN_THREADS} -p thread_pool_max=${VARNISH_MAX_THREADS} -S ${VARNISH_SECRET_FILE} -s ${VARNISH_STORAGE}"</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>In CentOS 6, it must be explicitely defined the <code>install_from_repo</code>
option because in the CentOS 6 repos it is the 2 version:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">varnish:
  ng:
    lookup:
      repo: 'varnish41'
    install_from_repo: True</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>For the Ubuntu 16 there is a problem regarding the usage of the
systemd; there is no other way than editing the systemd varnish unit
file to modify the init options (CentOS 7 has also systemd but there is
the <code>varnish.params</code> to bypass the edition of the unit file directly). A
little trick to automate this, is using the following pillar:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">varnish:
  ng:
    lookup:
      repo: 'varnish41'
      config: /etc/systemd/system/varnish.service
    config_source_path: salt://hostname/varnish-systemd</code></pre>
</div>
</div>
<div class="paragraph">
<p>Being <code>varnish-systemd</code> the varnish systemd unit file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ini hljs" data-lang="ini">[Unit]
Description=Varnish Cache, a high-performance HTTP accelerator

[Service]
Type=forking

# Maximum number of open files (for ulimit -n)
LimitNOFILE=131072

# Locked shared memory - should suffice to lock the shared memory log
# (varnishd -l argument)
# Default log size is 80MB vsl + 1M vsm + header -&gt; 82MB
# unit is bytes
LimitMEMLOCK=85983232

# On systemd &gt;= 228 enable this to avoid "fork failed" on reload.
#TasksMax=infinity

# Maximum size of the corefile.
LimitCORE=infinity

# Set WARMUP_TIME to force a delay in reload-vcl between vcl.load and vcl.use
# This is useful when backend probe definitions need some time before declaring
# configured backends healthy, to avoid routing traffic to a non-healthy backend.
#WARMUP_TIME=0

ExecStart=/usr/sbin/varnishd -a :6081 -T localhost:6082 -f /etc/varnish/default.vcl -S /etc/varnish/secret -s malloc,120m
ExecReload=/usr/share/varnish/reload-vcl

[Install]
WantedBy=multi-user.target</code></pre>
</div>
</div>
<div class="paragraph">
<p>So you can edit and have the file managed by salt.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Varnish versions from 6 (including it) have change the systemd unit
service; are OS agnostic (see
<a href="https://varnish-cache.org/docs/trunk/whats-new/upgrading-6.0.html#packaging-changes">packaging
changes</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For Debian Family OSes can use the previous trick (changing the unit
service).</p>
</div>
<div class="paragraph">
<p>For RedHat Family OSes there is a new variable <code>version</code> that setup an
<code>override.conf</code> for the default varnish systemd service that allow to
use the <code>varnish.params</code> file. For example, to install varnish 6 LTS:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">varnish:
  ng:
    lookup:
      repo: 'varnish60lts'
    version: '6'
    install_from_repo: True
    enabled: True
    config_source_path: salt://hostname/varnish.params.jinja
    vcl:
      files:
        default:
          path: /etc/varnish/default.vcl
          source_path: salt://hostname/default.vcl.jinja</code></pre>
</div>
</div>
<div class="paragraph">
<p>This change is compatible with other varnish versions (there is no error
if not set).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing"><a class="anchor" href="#_testing"></a>8. Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Linux testing is done with <code>kitchen-salt</code>.</p>
</div>
<div class="sect2">
<h3 id="_requirements"><a class="anchor" href="#_requirements"></a>8.1. Requirements</h3>
<div class="ulist">
<ul>
<li>
<p>Ruby</p>
</li>
<li>
<p>Docker</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ gem install bundler
$ bundle install
$ bin/kitchen test [platform]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>[platform]</code> is the platform name defined in <code>kitchen.yml</code>, e.g.
<code>debian-9-2019-2-py3</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_binkitchen_converge"><a class="anchor" href="#_binkitchen_converge"></a>8.2. <code>bin/kitchen converge</code></h3>
<div class="paragraph">
<p>Creates the docker instance and runs the <code>template</code> main state, ready
for testing.</p>
</div>
</div>
<div class="sect2">
<h3 id="_binkitchen_verify"><a class="anchor" href="#_binkitchen_verify"></a>8.3. <code>bin/kitchen verify</code></h3>
<div class="paragraph">
<p>Runs the <code>inspec</code> tests on the actual instance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_binkitchen_destroy"><a class="anchor" href="#_binkitchen_destroy"></a>8.4. <code>bin/kitchen destroy</code></h3>
<div class="paragraph">
<p>Removes the docker instance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_binkitchen_test"><a class="anchor" href="#_binkitchen_test"></a>8.5. <code>bin/kitchen test</code></h3>
<div class="paragraph">
<p>Runs all of the stages above in one go: i.e. <code>destroy</code> + <code>converge</code><br>
<code>verify</code> + <code>destroy</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_binkitchen_login"><a class="anchor" href="#_binkitchen_login"></a>8.6. <code>bin/kitchen login</code></h3>
<div class="paragraph">
<p>Gives you SSH access to the instance for manual testing.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="next"><a href="CHANGELOG.html">Changelog</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using a customised version of the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/vendor/search.js" id="search-script" data-base-path="../.." data-page-path="/varnish-formula/0.4.1/README.html"></script>
<script async src="../../_/../search-index.js"></script>
<script src="../../_/js/vendor/tabs-block-behavior.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
